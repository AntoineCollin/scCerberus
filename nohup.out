test_obs=donor1
train_obs=donor2
2024-04-02 23:43:23.615301: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-04-02 23:43:23.684776: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-04-02 23:43:23.685017: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-04-02 23:43:23.686571: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-04-02 23:43:23.696579: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE4.1 SSE4.2 AVX AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
tf [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
tf [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
[neptune] [info   ] Neptune initialized. Open in the app: https://app.neptune.ai/becavin-lab/sc-permut-packaging/
[neptune] [info   ] Shutting down background jobs, please wait a moment...
[neptune] [info   ] Done!
[neptune] [info   ] Explore the metadata in the Neptune app: https://app.neptune.ai/becavin-lab/sc-permut-packaging/metadata
[INFO 04-02 23:43:36] ax.service.ax_client: Starting optimization with verbose logging. To disable logging, set the `verbose_logging` argument to `False`. Note that float values in the logs are rounded to 6 decimal points.
/data/analysis/ML_models/conda_env/sc_permut_2/lib/python3.11/site-packages/ax/core/parameter.py:594: UserWarning: `is_ordered` is not specified for `ChoiceParameter` "ae_bottleneck_activation". Defaulting to `False` for parameters of `ParameterType` STRING. To override this behavior (or avoid this warning), specify `is_ordered` during `ChoiceParameter` construction.
  warn(
/data/analysis/ML_models/conda_env/sc_permut_2/lib/python3.11/site-packages/ax/core/parameter.py:594: UserWarning: `sort_values` is not specified for `ChoiceParameter` "ae_bottleneck_activation". Defaulting to `False` for parameters of `ParameterType` STRING. To override this behavior (or avoid this warning), specify `sort_values` during `ChoiceParameter` construction.
  warn(
/data/analysis/ML_models/conda_env/sc_permut_2/lib/python3.11/site-packages/ax/core/parameter.py:594: UserWarning: `is_ordered` is not specified for `ChoiceParameter` "size_factor". Defaulting to `False` for parameters of `ParameterType` STRING. To override this behavior (or avoid this warning), specify `is_ordered` during `ChoiceParameter` construction.
  warn(
/data/analysis/ML_models/conda_env/sc_permut_2/lib/python3.11/site-packages/ax/core/parameter.py:594: UserWarning: `sort_values` is not specified for `ChoiceParameter` "size_factor". Defaulting to `False` for parameters of `ParameterType` STRING. To override this behavior (or avoid this warning), specify `sort_values` during `ChoiceParameter` construction.
  warn(
[INFO 04-02 23:43:36] ax.service.utils.instantiation: Created search space: SearchSpace(parameters=[RangeParameter(name='use_hvg', parameter_type=INT, range=[1000, 5000]), RangeParameter(name='batch_size', parameter_type=INT, range=[64, 512]), RangeParameter(name='clas_w', parameter_type=FLOAT, range=[0.0001, 100.0], log_scale=True), RangeParameter(name='rec_w', parameter_type=FLOAT, range=[0.0001, 30.0], log_scale=True), RangeParameter(name='dann_w', parameter_type=FLOAT, range=[0.0001, 100.0], log_scale=True), ChoiceParameter(name='ae_bottleneck_activation', parameter_type=STRING, values=['linear', 'relu', 'sigmoid'], is_ordered=False, sort_values=False), ChoiceParameter(name='size_factor', parameter_type=STRING, values=['raw', 'constant', 'default'], is_ordered=False, sort_values=False), RangeParameter(name='learning_rate', parameter_type=FLOAT, range=[0.0001, 0.01], log_scale=True), RangeParameter(name='weight_decay', parameter_type=FLOAT, range=[1e-08, 0.0001], log_scale=True), RangeParameter(name='warmup_epoch', parameter_type=INT, range=[1, 70]), RangeParameter(name='dropout', parameter_type=FLOAT, range=[0.0, 0.5]), RangeParameter(name='bottleneck', parameter_type=INT, range=[32, 128]), RangeParameter(name='layer2', parameter_type=INT, range=[32, 512]), RangeParameter(name='layer1', parameter_type=INT, range=[512, 2048])], parameter_constraints=[]).
[INFO 04-02 23:43:36] ax.modelbridge.dispatch_utils: Using Models.BOTORCH_MODULAR since there are more ordered parameters than there are categories for the unordered categorical parameters.
[INFO 04-02 23:43:36] ax.modelbridge.dispatch_utils: Calculating the number of remaining initialization trials based on num_initialization_trials=None max_initialization_trials=None num_tunable_parameters=14 num_trials=None use_batch_trials=False
[INFO 04-02 23:43:36] ax.modelbridge.dispatch_utils: calculated num_initialization_trials=28
[INFO 04-02 23:43:36] ax.modelbridge.dispatch_utils: num_completed_initialization_trials=0 num_remaining_initialization_trials=28
[INFO 04-02 23:43:36] ax.modelbridge.dispatch_utils: `verbose`, `disable_progbar`, and `jit_compile` are not yet supported when using `choose_generation_strategy` with ModularBoTorchModel, dropping these arguments.
[INFO 04-02 23:43:36] ax.modelbridge.dispatch_utils: Using Bayesian Optimization generation strategy: GenerationStrategy(name='Sobol+BoTorch', steps=[Sobol for 28 trials, BoTorch for subsequent trials]). Iterations after 28 will take longer to generate due to model-fitting.
[INFO 04-02 23:43:36] ax.service.ax_client: Generated new trial 0 with parameters {'use_hvg': 2481, 'batch_size': 509, 'clas_w': 0.001706, 'rec_w': 0.010649, 'dann_w': 2.200013, 'learning_rate': 0.000116, 'weight_decay': 1e-06, 'warmup_epoch': 47, 'dropout': 0.338469, 'bottleneck': 99, 'layer2': 507, 'layer1': 1795, 'ae_bottleneck_activation': 'linear', 'size_factor': 'default'} using model Sobol.
2024-04-02 23:43:36.929090: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1929] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38362 MB memory:  -> device: 0, name: NVIDIA A100-PCIE-40GB, pci bus id: 0000:37:00.0, compute capability: 8.0
[neptune] [info   ] Neptune initialized. Open in the app: https://app.neptune.ai/becavin-lab/sc-permut-packaging/e/SCPERP1-339
/data/analysis/ML_models/conda_env/sc_permut_2/lib/python3.11/site-packages/scpermut/workflow/dataset.py:331: ImplicitModificationWarning: Trying to modify attribute `.obs` of view, initializing view as actual.
  self.adata_train_extended.obs['train_split'] = to_keep
/data/analysis/ML_models/conda_env/sc_permut_2/lib/python3.11/site-packages/keras/src/optimizers/base_optimizer.py:576: UserWarning: Gradients do not exist for variables ['kernel', 'bias', 'gamma', 'beta', 'kernel', 'bias'] when minimizing the loss. If using `model.compile()`, did you forget to provide a `loss` argument?
  warnings.warn(
[neptune] [warning] /home/becavin/scPermut/scpermut/workflow/optimize_hp.py:604: NeptuneUnsupportedType: You're attempting to log a type that is not directly supported by Neptune (<class 'list'>).
        Convert the value to a supported type, such as a string or float, or use stringify_unsupported(obj)
        for dictionaries or collections that contain unsupported values.
        For more, see https://docs.neptune.ai/help/value_of_unsupported_type
dataset loaded at /data/analysis/data_becavin/scpermut_test//data/tran_2021.h5ad
Searching for highly variable genes in 3 batches
Found 1362 highly variable genes using 3 batches
Searching for highly variable genes in 2 batches
Found 753 highly variable genes using 2 batches
Searching for highly variable genes in 1 batches
Found 1851 highly variable genes using 1 batches. Selecting top 366
test obs :['donor1']
splitting this adata train/val : View of AnnData object with n_obs × n_vars = 5754 × 2481
    obs: 'Dataset', 'donor_id', 'development_stage', 'sex', 'suspension_type', 'assay', 'Original_annotation', 'CellHint_harmonised_group', 'cell_type', 'Curated_annotation', 'organism', 'disease', 'tissue', 'batch', 'Original_annotation_batch', 'TRAIN_TEST_split', 'TRAIN_TEST_split_batch', 'n_genes', 'true_Original_annotation', 'n_counts', 'size_factors'
    var: 'exist_in_Ayhan2021', 'exist_in_Franjic2022', 'exist_in_Tran2021', 'exist_in_Siletti2022', 'n_cells', 'n_counts'
    uns: 'Curated_annotation_colors', 'Original_annotation_colors', 'donor_id_colors', 'schema_version', 'title', 'log1p'
    obsm: 'X_uce', 'X_umap'
train, test, val proportions : train_split
test     4313
train    3909
val      1845
Name: count, dtype: int64
dataset has been preprocessed
WARMUPDANNNNNNNN 47
COMPLETE 100
bottleneck activation : linear
Step number 0, running warmup_dann strategy with permutation = False for 47 epochs
Epoch 1/147, Current strat Epoch 1/47
obs 10067
AnnData object with n_obs × n_vars = 10067 × 2481
    obs: 'Dataset', 'donor_id', 'development_stage', 'sex', 'suspension_type', 'assay', 'Original_annotation', 'CellHint_harmonised_group', 'cell_type', 'Curated_annotation', 'organism', 'disease', 'tissue', 'batch', 'Original_annotation_batch', 'TRAIN_TEST_split', 'TRAIN_TEST_split_batch', 'n_genes', 'true_Original_annotation', 'n_counts', 'size_factors', 'train_split'
    var: 'exist_in_Ayhan2021', 'exist_in_Franjic2022', 'exist_in_Tran2021', 'exist_in_Siletti2022', 'n_cells', 'n_counts'
    uns: 'Curated_annotation_colors', 'Original_annotation_colors', 'donor_id_colors', 'schema_version', 'title', 'log1p'
    obsm: 'X_uce', 'X_umap'
obs 20
Step - Switching permutation
Step - Switching permutation
133132
Epoch 2/147, Current strat Epoch 2/47
obs 10067
AnnData object with n_obs × n_vars = 10067 × 2481
    obs: 'Dataset', 'donor_id', 'development_stage', 'sex', 'suspension_type', 'assay', 'Original_annotation', 'CellHint_harmonised_group', 'cell_type', 'Curated_annotation', 'organism', 'disease', 'tissue', 'batch', 'Original_annotation_batch', 'TRAIN_TEST_split', 'TRAIN_TEST_split_batch', 'n_genes', 'true_Original_annotation', 'n_counts', 'size_factors', 'train_split'
    var: 'exist_in_Ayhan2021', 'exist_in_Franjic2022', 'exist_in_Tran2021', 'exist_in_Siletti2022', 'n_cells', 'n_counts'
    uns: 'Curated_annotation_colors', 'Original_annotation_colors', 'donor_id_colors', 'schema_version', 'title', 'log1p'
    obsm: 'X_uce', 'X_umap'
obs 20
Step - Switching permutation
Step - Switching permutation
96259689
Epoch 3/147, Current strat Epoch 3/47
obs 10067
AnnData object with n_obs × n_vars = 10067 × 2481
    obs: 'Dataset', 'donor_id', 'development_stage', 'sex', 'suspension_type', 'assay', 'Original_annotation', 'CellHint_harmonised_group', 'cell_type', 'Curated_annotation', 'organism', 'disease', 'tissue', 'batch', 'Original_annotation_batch', 'TRAIN_TEST_split', 'TRAIN_TEST_split_batch', 'n_genes', 'true_Original_annotation', 'n_counts', 'size_factors', 'train_split'
    var: 'exist_in_Ayhan2021', 'exist_in_Franjic2022', 'exist_in_Tran2021', 'exist_in_Siletti2022', 'n_cells', 'n_counts'
    uns: 'Curated_annotation_colors', 'Original_annotation_colors', 'donor_id_colors', 'schema_version', 'title', 'log1p'
    obsm: 'X_uce', 'X_umap'
obs 20
Step - Switching permutation
Step - Switching permutation
12675476
Epoch 4/147, Current strat Epoch 4/47
obs 10067
AnnData object with n_obs × n_vars = 10067 × 2481
    obs: 'Dataset', 'donor_id', 'development_stage', 'sex', 'suspension_type', 'assay', 'Original_annotation', 'CellHint_harmonised_group', 'cell_type', 'Curated_annotation', 'organism', 'disease', 'tissue', 'batch', 'Original_annotation_batch', 'TRAIN_TEST_split', 'TRAIN_TEST_split_batch', 'n_genes', 'true_Original_annotation', 'n_counts', 'size_factors', 'train_split'
    var: 'exist_in_Ayhan2021', 'exist_in_Franjic2022', 'exist_in_Tran2021', 'exist_in_Siletti2022', 'n_cells', 'n_counts'
    uns: 'Curated_annotation_colors', 'Original_annotation_colors', 'donor_id_colors', 'schema_version', 'title', 'log1p'
    obsm: 'X_uce', 'X_umap'
obs 20
Step - Switching permutation
Step - Switching permutation
82102012
Epoch 5/147, Current strat Epoch 5/47
obs 10067
AnnData object with n_obs × n_vars = 10067 × 2481
    obs: 'Dataset', 'donor_id', 'development_stage', 'sex', 'suspension_type', 'assay', 'Original_annotation', 'CellHint_harmonised_group', 'cell_type', 'Curated_annotation', 'organism', 'disease', 'tissue', 'batch', 'Original_annotation_batch', 'TRAIN_TEST_split', 'TRAIN_TEST_split_batch', 'n_genes', 'true_Original_annotation', 'n_counts', 'size_factors', 'train_split'
    var: 'exist_in_Ayhan2021', 'exist_in_Franjic2022', 'exist_in_Tran2021', 'exist_in_Siletti2022', 'n_cells', 'n_counts'
    uns: 'Curated_annotation_colors', 'Original_annotation_colors', 'donor_id_colors', 'schema_version', 'title', 'log1p'
    obsm: 'X_uce', 'X_umap'
obs 20
Step - Switching permutation
Step - Switching permutation
51307296
Epoch 6/147, Current strat Epoch 6/47
obs 10067
AnnData object with n_obs × n_vars = 10067 × 2481
    obs: 'Dataset', 'donor_id', 'development_stage', 'sex', 'suspension_type', 'assay', 'Original_annotation', 'CellHint_harmonised_group', 'cell_type', 'Curated_annotation', 'organism', 'disease', 'tissue', 'batch', 'Original_annotation_batch', 'TRAIN_TEST_split', 'TRAIN_TEST_split_batch', 'n_genes', 'true_Original_annotation', 'n_counts', 'size_factors', 'train_split'
    var: 'exist_in_Ayhan2021', 'exist_in_Franjic2022', 'exist_in_Tran2021', 'exist_in_Siletti2022', 'n_cells', 'n_counts'
    uns: 'Curated_annotation_colors', 'Original_annotation_colors', 'donor_id_colors', 'schema_version', 'title', 'log1p'
    obsm: 'X_uce', 'X_umap'
obs 20
Step - Switching permutation
Step - Switching permutation
32524490
Epoch 7/147, Current strat Epoch 7/47
obs 10067
AnnData object with n_obs × n_vars = 10067 × 2481
    obs: 'Dataset', 'donor_id', 'development_stage', 'sex', 'suspension_type', 'assay', 'Original_annotation', 'CellHint_harmonised_group', 'cell_type', 'Curated_annotation', 'organism', 'disease', 'tissue', 'batch', 'Original_annotation_batch', 'TRAIN_TEST_split', 'TRAIN_TEST_split_batch', 'n_genes', 'true_Original_annotation', 'n_counts', 'size_factors', 'train_split'
    var: 'exist_in_Ayhan2021', 'exist_in_Franjic2022', 'exist_in_Tran2021', 'exist_in_Siletti2022', 'n_cells', 'n_counts'
    uns: 'Curated_annotation_colors', 'Original_annotation_colors', 'donor_id_colors', 'schema_version', 'title', 'log1p'
    obsm: 'X_uce', 'X_umap'
obs 20
Step - Switching permutation
Step - Switching permutation
48700904
Epoch 8/147, Current strat Epoch 8/47
obs 10067
AnnData object with n_obs × n_vars = 10067 × 2481
    obs: 'Dataset', 'donor_id', 'development_stage', 'sex', 'suspension_type', 'assay', 'Original_annotation', 'CellHint_harmonised_group', 'cell_type', 'Curated_annotation', 'organism', 'disease', 'tissue', 'batch', 'Original_annotation_batch', 'TRAIN_TEST_split', 'TRAIN_TEST_split_batch', 'n_genes', 'true_Original_annotation', 'n_counts', 'size_factors', 'train_split'
    var: 'exist_in_Ayhan2021', 'exist_in_Franjic2022', 'exist_in_Tran2021', 'exist_in_Siletti2022', 'n_cells', 'n_counts'
    uns: 'Curated_annotation_colors', 'Original_annotation_colors', 'donor_id_colors', 'schema_version', 'title', 'log1p'
    obsm: 'X_uce', 'X_umap'
obs 20
Step - Switching permutation
Step - Switching permutation
2340698
Epoch 9/147, Current strat Epoch 9/47
obs 10067
AnnData object with n_obs × n_vars = 10067 × 2481
    obs: 'Dataset', 'donor_id', 'development_stage', 'sex', 'suspension_type', 'assay', 'Original_annotation', 'CellHint_harmonised_group', 'cell_type', 'Curated_annotation', 'organism', 'disease', 'tissue', 'batch', 'Original_annotation_batch', 'TRAIN_TEST_split', 'TRAIN_TEST_split_batch', 'n_genes', 'true_Original_annotation', 'n_counts', 'size_factors', 'train_split'
    var: 'exist_in_Ayhan2021', 'exist_in_Franjic2022', 'exist_in_Tran2021', 'exist_in_Siletti2022', 'n_cells', 'n_counts'
    uns: 'Curated_annotation_colors', 'Original_annotation_colors', 'donor_id_colors', 'schema_version', 'title', 'log1p'
    obsm: 'X_uce', 'X_umap'
obs 20
Step - Switching permutation
Step - Switching permutation
24111938
Epoch 10/147, Current strat Epoch 10/47
obs 10067
AnnData object with n_obs × n_vars = 10067 × 2481
    obs: 'Dataset', 'donor_id', 'development_stage', 'sex', 'suspension_type', 'assay', 'Original_annotation', 'CellHint_harmonised_group', 'cell_type', 'Curated_annotation', 'organism', 'disease', 'tissue', 'batch', 'Original_annotation_batch', 'TRAIN_TEST_split', 'TRAIN_TEST_split_batch', 'n_genes', 'true_Original_annotation', 'n_counts', 'size_factors', 'train_split'
    var: 'exist_in_Ayhan2021', 'exist_in_Franjic2022', 'exist_in_Tran2021', 'exist_in_Siletti2022', 'n_cells', 'n_counts'
    uns: 'Curated_annotation_colors', 'Original_annotation_colors', 'donor_id_colors', 'schema_version', 'title', 'log1p'
    obsm: 'X_uce', 'X_umap'
obs 20
Step - Switching permutation
Step - Switching permutation
99883270
Epoch 11/147, Current strat Epoch 11/47
obs 10067
AnnData object with n_obs × n_vars = 10067 × 2481
    obs: 'Dataset', 'donor_id', 'development_stage', 'sex', 'suspension_type', 'assay', 'Original_annotation', 'CellHint_harmonised_group', 'cell_type', 'Curated_annotation', 'organism', 'disease', 'tissue', 'batch', 'Original_annotation_batch', 'TRAIN_TEST_split', 'TRAIN_TEST_split_batch', 'n_genes', 'true_Original_annotation', 'n_counts', 'size_factors', 'train_split'
    var: 'exist_in_Ayhan2021', 'exist_in_Franjic2022', 'exist_in_Tran2021', 'exist_in_Siletti2022', 'n_cells', 'n_counts'
    uns: 'Curated_annotation_colors', 'Original_annotation_colors', 'donor_id_colors', 'schema_version', 'title', 'log1p'
    obsm: 'X_uce', 'X_umap'
obs 20
Step - Switching permutation
Step - Switching permutation
86991310
Epoch 12/147, Current strat Epoch 12/47
obs 10067
AnnData object with n_obs × n_vars = 10067 × 2481
    obs: 'Dataset', 'donor_id', 'development_stage', 'sex', 'suspension_type', 'assay', 'Original_annotation', 'CellHint_harmonised_group', 'cell_type', 'Curated_annotation', 'organism', 'disease', 'tissue', 'batch', 'Original_annotation_batch', 'TRAIN_TEST_split', 'TRAIN_TEST_split_batch', 'n_genes', 'true_Original_annotation', 'n_counts', 'size_factors', 'train_split'
    var: 'exist_in_Ayhan2021', 'exist_in_Franjic2022', 'exist_in_Tran2021', 'exist_in_Siletti2022', 'n_cells', 'n_counts'
    uns: 'Curated_annotation_colors', 'Original_annotation_colors', 'donor_id_colors', 'schema_version', 'title', 'log1p'
    obsm: 'X_uce', 'X_umap'
obs 20
Step - Switching permutation
Step - Switching permutation
56744384
Epoch 13/147, Current strat Epoch 13/47
obs 10067
AnnData object with n_obs × n_vars = 10067 × 2481
    obs: 'Dataset', 'donor_id', 'development_stage', 'sex', 'suspension_type', 'assay', 'Original_annotation', 'CellHint_harmonised_group', 'cell_type', 'Curated_annotation', 'organism', 'disease', 'tissue', 'batch', 'Original_annotation_batch', 'TRAIN_TEST_split', 'TRAIN_TEST_split_batch', 'n_genes', 'true_Original_annotation', 'n_counts', 'size_factors', 'train_split'
    var: 'exist_in_Ayhan2021', 'exist_in_Franjic2022', 'exist_in_Tran2021', 'exist_in_Siletti2022', 'n_cells', 'n_counts'
    uns: 'Curated_annotation_colors', 'Original_annotation_colors', 'donor_id_colors', 'schema_version', 'title', 'log1p'
    obsm: 'X_uce', 'X_umap'
obs 20
Step - Switching permutation
Step - Switching permutation
82389450
Epoch 14/147, Current strat Epoch 14/47
obs 10067
AnnData object with n_obs × n_vars = 10067 × 2481
    obs: 'Dataset', 'donor_id', 'development_stage', 'sex', 'suspension_type', 'assay', 'Original_annotation', 'CellHint_harmonised_group', 'cell_type', 'Curated_annotation', 'organism', 'disease', 'tissue', 'batch', 'Original_annotation_batch', 'TRAIN_TEST_split', 'TRAIN_TEST_split_batch', 'n_genes', 'true_Original_annotation', 'n_counts', 'size_factors', 'train_split'
    var: 'exist_in_Ayhan2021', 'exist_in_Franjic2022', 'exist_in_Tran2021', 'exist_in_Siletti2022', 'n_cells', 'n_counts'
    uns: 'Curated_annotation_colors', 'Original_annotation_colors', 'donor_id_colors', 'schema_version', 'title', 'log1p'
    obsm: 'X_uce', 'X_umap'
obs 20
Step - Switching permutation
Step - Switching permutation
45544052
Epoch 15/147, Current strat Epoch 15/47
obs 10067
AnnData object with n_obs × n_vars = 10067 × 2481
    obs: 'Dataset', 'donor_id', 'development_stage', 'sex', 'suspension_type', 'assay', 'Original_annotation', 'CellHint_harmonised_group', 'cell_type', 'Curated_annotation', 'organism', 'disease', 'tissue', 'batch', 'Original_annotation_batch', 'TRAIN_TEST_split', 'TRAIN_TEST_split_batch', 'n_genes', 'true_Original_annotation', 'n_counts', 'size_factors', 'train_split'
    var: 'exist_in_Ayhan2021', 'exist_in_Franjic2022', 'exist_in_Tran2021', 'exist_in_Siletti2022', 'n_cells', 'n_counts'
    uns: 'Curated_annotation_colors', 'Original_annotation_colors', 'donor_id_colors', 'schema_version', 'title', 'log1p'
    obsm: 'X_uce', 'X_umap'
obs 20
Step - Switching permutation
Step - Switching permutation
91915130
Epoch 16/147, Current strat Epoch 16/47
obs 10067
AnnData object with n_obs × n_vars = 10067 × 2481
    obs: 'Dataset', 'donor_id', 'development_stage', 'sex', 'suspension_type', 'assay', 'Original_annotation', 'CellHint_harmonised_group', 'cell_type', 'Curated_annotation', 'organism', 'disease', 'tissue', 'batch', 'Original_annotation_batch', 'TRAIN_TEST_split', 'TRAIN_TEST_split_batch', 'n_genes', 'true_Original_annotation', 'n_counts', 'size_factors', 'train_split'
    var: 'exist_in_Ayhan2021', 'exist_in_Franjic2022', 'exist_in_Tran2021', 'exist_in_Siletti2022', 'n_cells', 'n_counts'
    uns: 'Curated_annotation_colors', 'Original_annotation_colors', 'donor_id_colors', 'schema_version', 'title', 'log1p'
    obsm: 'X_uce', 'X_umap'
obs 20
Step - Switching permutation
Step - Switching permutation
72673606
Epoch 17/147, Current strat Epoch 17/47
obs 10067
AnnData object with n_obs × n_vars = 10067 × 2481
    obs: 'Dataset', 'donor_id', 'development_stage', 'sex', 'suspension_type', 'assay', 'Original_annotation', 'CellHint_harmonised_group', 'cell_type', 'Curated_annotation', 'organism', 'disease', 'tissue', 'batch', 'Original_annotation_batch', 'TRAIN_TEST_split', 'TRAIN_TEST_split_batch', 'n_genes', 'true_Original_annotation', 'n_counts', 'size_factors', 'train_split'
    var: 'exist_in_Ayhan2021', 'exist_in_Franjic2022', 'exist_in_Tran2021', 'exist_in_Siletti2022', 'n_cells', 'n_counts'
    uns: 'Curated_annotation_colors', 'Original_annotation_colors', 'donor_id_colors', 'schema_version', 'title', 'log1p'
    obsm: 'X_uce', 'X_umap'
obs 20
Step - Switching permutation
Step - Switching permutation
83066940
Epoch 18/147, Current strat Epoch 18/47
obs 10067
AnnData object with n_obs × n_vars = 10067 × 2481
    obs: 'Dataset', 'donor_id', 'development_stage', 'sex', 'suspension_type', 'assay', 'Original_annotation', 'CellHint_harmonised_group', 'cell_type', 'Curated_annotation', 'organism', 'disease', 'tissue', 'batch', 'Original_annotation_batch', 'TRAIN_TEST_split', 'TRAIN_TEST_split_batch', 'n_genes', 'true_Original_annotation', 'n_counts', 'size_factors', 'train_split'
    var: 'exist_in_Ayhan2021', 'exist_in_Franjic2022', 'exist_in_Tran2021', 'exist_in_Siletti2022', 'n_cells', 'n_counts'
    uns: 'Curated_annotation_colors', 'Original_annotation_colors', 'donor_id_colors', 'schema_version', 'title', 'log1p'
    obsm: 'X_uce', 'X_umap'
obs 20
Step - Switching permutation
Step - Switching permutation
39056587
